<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[there be code here]]></title>
  <link href="http://kaylee42.github.io/atom.xml" rel="self"/>
  <link href="http://kaylee42.github.io/"/>
  <updated>2016-01-28T10:51:34-05:00</updated>
  <id>http://kaylee42.github.io/</id>
  <author>
    <name><![CDATA[Kaylee Knowles]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Understanding jQuery &amp; the DOM]]></title>
    <link href="http://kaylee42.github.io/blog/2016/01/27/understanding-jquery-and-the-dom/"/>
    <updated>2016-01-27T09:29:41-05:00</updated>
    <id>http://kaylee42.github.io/blog/2016/01/27/understanding-jquery-and-the-dom</id>
    <content type="html"><![CDATA[<p>As someone whose first programming language was Ruby, the transition into JavaScript was rocky, to say the least. But after a week of near-constant rage fueled by missing the 16th closing curly brace and forgetting that my functions won’t do shit unless I call them, I think I’m starting to come to terms with JavaScript, and maybe even… like it a little? And that’s all thanks to jQuery, because jQuery just makes everything in JS so much easier and better, especially when interacting with the DOM.</p>

<p>But I definitely didn’t feel that way at first. No, at first the way I felt about jQuery was more or less: WTF are all these frigging $ about? Why did all these things I learned in regular ol’ JavaScript suddenly stop working? Why aren’t these effing jQuery methods working when I think they should? And WTF are DOM elements anyway?!?!?</p>

<p>&hellip; I think I get it now. So the following is the first of two posts documenting how I found the answer to what may seem (at least to those more familiar with JavaScript than I) a fairly basic question: What the hell does it mean when someone tells you that a jQuery object is an array-like collection of DOM elements? This post assumes you have basic experience with HTML, CSS, and JavaScript, but not much else.</p>

<h2>THE DOM</h2>

<p>Let’s start at the beginning: What on earth is the DOM? I had a vague understanding of the DOM as like… something in the browser… that uses HTML? But that didn’t really seem good enough. So I found the official definition from the <a href="https://www.w3.org/DOM/">World Wide Web Consortium</a>, the group that maintains standards for the DOM:</p>

<blockquote><p>The Document Object Model is a platform- and language-neutral interface that will allow programs and scripts to dynamically access and update the content, structure and style of documents. The document can be further processed and the results of that processing can be incorporated back into the presented page.</p></blockquote>

<p>Well, thanks for nothing, W3C. Luckily, other definitions of the DOM exist out there, and have led me to this understanding of a few keys points:</p>

<ul>
<li>The DOM is a <strong>standard model</strong>, so it is interpreted the same regardless of browser or language.</li>
<li>The DOM allows us to access and interact with <strong>HTML elements as objects</strong> (it is object-oriented).</li>
<li>The DOM connects web pages to our scripts by providing a <strong>structured representation</strong> of those objects.</li>
</ul>


<p>In other words, the DOM facilitates our access to HTML elements by representing them as objects, and allowing us to use JavaScript (or another language) to easily access and manipulate that HTML. Let’s take a closer look at what that means for us as programmers.</p>

<p><em>Note: The DOM isn’t only for HTML (it also has models for XML and the Core DOM) but those aren’t important for the purposes of this post.</em></p>

<h2>DOM ELEMENTS AND JAVASCRIPT</h2>

<p>Here’s a visual representation of what the hell is going on in the DOM:
<img src="http://kaylee42.github.io/images/jquerydom/pic_htmltree.gif" alt="DOM tree" /></p>

<p>Source: <a href="http://www.w3schools.com/js/js_htmldom.asp">W3 Schools</a></p>

<p>All of those boxes represent different kinds of <a href="https://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1950641247">nodes</a>, which are the primary datatypes used by the DOM. In other words, nodes are the friendly little objects that the DOM turns our HTML into! There are a bunch of different node types, only a few of which are represented here, but we’re primarily interested in the <code>element</code> type, because this is primarily what we’ll be calling on in both JavaScript and jQuery methods. (There is limited support for other nodes like <code>text</code> and <code>comment</code> in SOME methods, but their use is not encouraged.)</p>

<p>What is a DOM element exactly? Easy: if you write it in an HTML tag, it’s an element. Here’s some elements:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;body&gt;&lt;/body&gt;</span> <span class="c">&lt;!--woah it&#39;s an element!--&gt;</span>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>RAWR<span class="nt">&lt;/h1&gt;</span> <span class="c">&lt;!--omg another one!--&gt;</span>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;magic&quot;</span><span class="nt">&gt;</span>OMG MAGIX<span class="nt">&lt;/div&gt;</span> <span class="c">&lt;!--elements for everyone!--&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The DOM standard allows us to use JavaScript to grab these elements and operate on them.</p>

<p>In vanilla JavaScript, we access the <code>document</code> object (the node which encapsulates every other node) in order to find a specific DOM element. So, for instance, if we were looking for a <code>div</code> with an id of <code>pterodactyl</code>, we could use the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">awesome</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;pterodactyl&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>and <code>awesome</code> now contains the pterodactyl <code>div</code> we were looking for. There are a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document#Methods">bunch of other JavaScript methods</a> like this for working directly with DOM elements, but honestly you should probably never use them because jQuery.</p>

<h2>JQUERY OBJECTS</h2>

<p>jQuery is just a JavaScript library that makes your life way better. jQuery objects are like DOM elements only way better. No really, they are pretty much exactly the same (only better). jQuery objects are infinitely easier to work with than DOM elements in their pure form and give us access to a plethora of <a href="https://api.jquery.com/category/manipulation/">super handy jQuery methods</a> that do things like allowing us to create animation and alter HTML at runtime. jQuery objects just provide a wrapper object that go around either a single DOM element or a collection of DOM elements, allowing us to use those methods.</p>

<p>There are way too many jQuery methods to go into here, but what I do want to explore are the ways available to get ahold of the jQuery object. The simplest is just to take a pre-existing DOM element and wrap it. That syntax looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">element</span> <span class="o">=</span> <span class="s2">&quot;&lt;p&gt;Hey there!&lt;/p&gt;&quot;</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>So that’s what all the $$$ is about! The <code>$()</code> syntax is just sugar for <code>jQuery()</code> - the jQuery wrapper object. As soon as we wrap the DOM element (or an array of DOM elements), we have access to all of the jQuery methods. The most common way you’ll see this implementation of getting a jQuery object is wrapping <code>$(this)</code> (demonstrated below), because usually you’ll want to get hold of jQuery objects using selectors.</p>

<p>Luckily, turns out this is also SUPER EASY. Just grab <a href="http://www.w3schools.com/cssref/css_selectors.asp">your favorite CSS selectors cheatsheet</a> and dive on in! Here are a few examples of how this would be implemented:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span> <span class="c1">// selects all h1 elements</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#rainbows&#39;</span><span class="p">)</span> <span class="c1">// selects the element with an ID of rainbow</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;a[href^=&quot;https&quot;]&#39;</span><span class="p">)</span> <span class="c1">// selects all a elements with an href attribute beginning with &quot;https&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can create any combination and use any CSS selectors you like. If you check it out in the console, the jQuery object you get back will look like this:
<img src="http://kaylee42.github.io/images/jquerydom/objects.png" alt="jQuery objects" />
In the first example I’ve selected all the elements with a class of <code>list</code>. I got three objects back, and we can see that it’s not just the tags, but all of the element’s attributes and children. The console allows you to expand and contract your view of the children.</p>

<p>In the second example I selected the object with an ID of <code>wrapper</code>. Note that even though it’s only a single object, is still comes with brackets around it - this array-like notation is an indication that the DOM element is wrapped in a jQuery object. (BUT NEVER FORGET THIS IS NOT AN ACTUAL ARRAY - see part two.)</p>

<p>A third, less common way to create a jQuery object is by wrapping an entire HTML string that does not yet exist on the page. This is less common largely because (to my understanding) it has a much more limited use case. You would want to do this primarily if you needed to call another method or act on the new object after you add it to the page. Here is an example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;li&gt;dance party&lt;/li&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;ul#funtimes&#39;</span><span class="p">)).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here we actually get so see ALL THREE of the jQuery object method syntaxes we’ve gone over. Let’s take it step by step. On line one we make a jQuery object by wrapping an HTML string that will add the item &ldquo;dancy party&rdquo; to a list. My making this HTML string into a jQuery object we gain access to the <code>appendTo()</code> method. As an argument to this method we use a jQuery object that we create through the use of CSS selectors (it’s the <code>&lt;ul&gt;</code> with an id of funtimes).</p>

<p>Great! Our list item is now appended. But we want to be able to hide it on a click (though like, why would you want to hide a dance party?) Luckily we can call the <code>on()</code> method and, thanks to some jQuery magic, have access to a <code>this</code> that isn’t the goddamn window. On line two we see the first method we talked about, directly wrapping up a DOM element (in this case <code>this</code>), which is the first jQuery object - the new string. And this is also why we constructed our first object directly from a string rather than doing the reverse formation:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;ul#funtimes&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;&lt;li&gt;dance party&lt;/li&gt;&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span> <span class="c1">// this isn’t what you think it is</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we had formulated it this way, when we referenced <code>this</code> we would have been accessing the <code>ul</code>, not the new list item we appended, and clicking would have hid the entirety of the list rather than the specific list item.</p>

<h2>FEELING GOOD?</h2>

<p>Hopefully by now you’ve got a grasp on what it means for something to be a jQuery object! But there’s plenty of quirks still to explore, so check out (the hopefully shorter) part two where we explore such fascinating topics as:
Why the hell isn’t this acting like an array?
Dammit, now I need to get the plain DOM element back.
What’s going on with <code>this</code> anyway?</p>

<h2>RESOURCES</h2>

<h3>THE DOM</h3>

<ul>
<li><a href="http://www.w3schools.com/js/js_htmldom.asp">W3 Schools: JavaScript HTML DOM</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction">MDN: Introduction to the DOM</a></li>
</ul>


<h3>JQUERY</h3>

<ul>
<li><a href="https://api.jquery.com/jquery/">jQuery API: jQuery()</a></li>
<li><a href="https://learn.jquery.com/using-jquery-core/jquery-object/">The jQuery Object</a></li>
<li><a href="https://www.smashingmagazine.com/2014/05/mystery-jquery-object-syntax-basic-introduction/">The Mystery of the jQuery Object: A Basic Introduction</a></li>
<li><a href="http://howtodoinjava.com/scripting/jquery/javascript-dom-objects-vs-jquery-objects/">Working with JavaScript DOM Objects vs. jQuery Objects</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Reflexive Self Joins in Rails]]></title>
    <link href="http://kaylee42.github.io/blog/2016/01/12/reflexive-self-joins-in-rails/"/>
    <updated>2016-01-12T06:56:20-05:00</updated>
    <id>http://kaylee42.github.io/blog/2016/01/12/reflexive-self-joins-in-rails</id>
    <content type="html"><![CDATA[<h2>OMG SELF JOINS</h2>

<p>Simply put, a self-join table allows us to join  an instance of a class to another instance of the same class in a many-to-many relationship. At first glance this is not so different from the more traditional join table used for has-many-through relationships, however because you cannot have two columns in the join table named <code>user_id</code>, implementing self joins requires some finagling.</p>

<p>Perhaps the most common real-world example of needing a self-join table is in social networking, connecting users to users through friendships or following relationships. I set out to implement this in my recent Rails project, and became particularly interested in the different methods available for using self join tables to create reflexive relationships. This blog will walk through all of my steps, but will particularly focus on reflexivity options.</p>

<h2>MIGRATION</h2>

<p>Creating a self-join table migration can be done nearly the same as to any other join table. Similarly, you can use <code>t.references</code>. In this case, I am creating a friendships model where one column is for :user_id, and the other is for :friend_id, although both have the id of an instance of the User class.</p>

<p>The main difference here is the way that the foreign key is added to the friend column. Because the two columns cannot both be named :user_id, and Rails will not automatically know which groups of foreign keys to check unless we explicitly tell it, this foreign key needs to be added outside of the create_table method. The example of the code is below, but it will always follow the format <code>add_foreign_key :join_table, :model_table, column: :second_name_id</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">CreateFriendships</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">change</span>
</span><span class='line'>    <span class="n">create_table</span> <span class="ss">:friendships</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">references</span> <span class="ss">:user</span><span class="p">,</span> <span class="ss">index</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">foreign_key</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">references</span> <span class="ss">:friend</span><span class="p">,</span> <span class="ss">index</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">timestamps</span> <span class="ss">null</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">add_foreign_key</span> <span class="ss">:friendships</span><span class="p">,</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">column</span><span class="p">:</span> <span class="ss">:friend_id</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>MODELS</h2>

<p>Now that we’ve migrated our table correctly, it’s time to write our models! Our Friendship model looks pretty familiar - it belongs to a <code>:user</code> and a <code>:friend</code>. However, a <code>:friend</code> is actually an instance of the User class. Usually Rails uses magic to automatically associate these relationships using naming conventions, but we can override these conventions when needed. It’s even pretty easy! Just append <code>class_name “Class”</code> to any foreign key that’s not named after its class.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Friendship</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:user</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:friend</span><span class="p">,</span> <span class="ss">class_name</span><span class="p">:</span> <span class="s2">&quot;User&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The implementation in our model looks super familiar. No need to identify which class <code>:friends</code> belongs to, as that’s handled in the Friendship model.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:friendships</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:friends</span><span class="p">,</span> <span class="ss">through</span><span class="p">:</span> <span class="ss">:friendships</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we can call <code>user.friends</code> to see what friends a given user has. However, as it stands our friends &amp; friendships leave something to be desired, as only the user identified in the <code>:user_id</code> column of our friendships table. Wouldn’t it be create if these relationships were more reflexive?</p>

<h2>ONE DIRECTIONAL (Twitter Model)</h2>

<p>One way to create reflexive relationships is what I think of as the Twitter model. These relationships are one-directional; a user can follow someone, and they can have followers, but those relationships are not mutual. In order to set up this relationship, we just need to add two lines of code to our previous User model:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:friendships</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:friends</span><span class="p">,</span> <span class="ss">through</span><span class="p">:</span> <span class="ss">:friendships</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:follows</span><span class="p">,</span> <span class="ss">class_name</span><span class="p">:</span> <span class="s2">&quot;Friendship&quot;</span><span class="p">,</span> <span class="ss">foreign_key</span><span class="p">:</span> <span class="s2">&quot;friend_id&quot;</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:followers</span><span class="p">,</span> <span class="ss">through</span><span class="p">:</span> <span class="ss">:follows</span><span class="p">,</span> <span class="ss">source</span><span class="p">:</span> <span class="ss">:user</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>What’s going on here? Let’s break it down. In line 5, we are defining a relationship to the friendships table that goes in the opposite direction. I’ve named it <code>:follows</code>, so the first thing we have to do is override Rails naming conventions to direct it to the proper class (Friendship), which we’ve seen before. But what about this <code>:foreign_key</code> business? Again, all we’re doing here is making explicit something that is implicit in Rails in order to override naming conventions. In a has_many relationship, it is assumed that the foreign key will be named after the class we’re in. However, in this case, we actually want to refer to the other side of that relationship - the <code>:friend_id</code>.</p>

<p>Line 6 is also fairly familiar - we just define <code>:followers</code> through the <code>:follows</code> relationship with just made. However, we again need to override our Rails naming conventions using source. This refers not to the name of the class, but the way the column is named in your join table - so just make it the opposite of whatever you defined as your foreign key in the previous line. Now we can call <code>user.followers</code> and see who has followed a give user!</p>

<h2>MUTUAL (Facebook Model)</h2>

<p>The second major way I found to create reflexive relationships is mutual - or what I think of as the Facebook model. In other words, if you friend someone, they also become friends with you. The easiest way I found to do this involved using callback methods.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Friendship</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:user</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:friend</span><span class="p">,</span> <span class="ss">class_name</span><span class="p">:</span> <span class="s2">&quot;User&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">after_create</span> <span class="ss">:create_inverse</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create_inverse</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="ss">user_id</span><span class="p">:</span> <span class="nb">self</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="ss">friend_id</span><span class="p">:</span> <span class="nb">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">validates_uniqueness_of</span> <span class="ss">:user_id</span><span class="p">,</span> <span class="ss">scope</span><span class="p">:</span> <span class="ss">:friend_id</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is actual pretty simply. All that’s happening is that a callback is being implemented in line 5 immediately after a new friendship is created. It simply calls the <code>:create_inverse</code> method which creates a second instance of the Friendship class with an inverse relationship to the original, guaranteeing that both users will be in each other’s collection of friends.</p>

<p>We avoid getting into an infinite creation loop because of uniqueness validation in line 11, which will validates for the uniqueness of <code>:user_id</code> as it relates to the scope of <code>:friend_id</code>.</p>

<p>Note: for some reason this works for me when implemented on my website, but does NOT work in the rails console.</p>

<h2>RESOURCES</h2>

<ul>
<li><a href="http://railscasts.com/episodes/163-self-referential-association?view=asciicast">Railscasts: Self-Referential Association</a></li>
<li><a href="http://collectiveidea.com/blog/archives/2015/07/30/bi-directional-and-self-referential-associations-in-rails/">Bi-Directional and Self-Referential Associations in Rails</a></li>
<li><a href="http://guides.rubyonrails.org/association_basics.html#self-joins">Rails Guides - Association Basics</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Diving Deeper into Pry]]></title>
    <link href="http://kaylee42.github.io/blog/2015/12/17/pry-pry-pry/"/>
    <updated>2015-12-17T18:30:20-05:00</updated>
    <id>http://kaylee42.github.io/blog/2015/12/17/pry-pry-pry</id>
    <content type="html"><![CDATA[<p>As a baby developer, my first encounters with pry were nothing short of terrifying. But that fear soon turned to love, and an obsession with understanding and exploring the extensive functionalities of this incredibly powerful tool.</p>

<p>This post explores only a few of the lesser-known tools pry provides, with an eye towards Ruby learners at the beginning of their journey. However, it does presume previous experience using pry breakpoints (<code>binding.pry</code>). If you haven&rsquo;t used it before, you may want to start with the resources at the bottom.</p>

<p>However, pry isn’t just for debugging - you can drop into pry from your terminal at any time simply by typing ‘pry’, and from there you are ready to begin experimenting! You can do anything you can do in irb in pry (only pry is better).</p>

<h2>PRY-DOC</h2>

<p>One of my personal favorite features of pry is actually a plugin called <a href="https://github.com/pry/pry-doc">pry-doc</a>. To install this, simply enter the following into terminal:</p>

<p><code>gem install pry-doc</code></p>

<p>What does this do? Oh you know… Just gives you access to the entire Ruby documentation straight from your terminal!!! I’ve found this incredibly helpful when I can’t remember exactly how a method operates, or need a few quick examples of it in action. Here is a generic example of how to search the documentation:</p>

<p><code>? Class/Module#method</code></p>

<p><code>?</code> is an alias of <code>show-doc</code> And here it is in action:</p>

<p><img src="http://kaylee42.github.io/images/pry/show-doc.png" alt="using show-doc with pry" /></p>

<p>But wait! Maybe you need to know more about the reject method, but can’t remember what class(es) it belongs to. How will you be able to search the documentation? Never fear, pry can help you with that too! Simply type <code>find-method reject</code> (or whatever method you want to find) and pry will pull up a list of classes and modules that can implement the method for you. Searching this way also does not have to be exact, so that our search for <code>reject</code> returns both <code>reject</code> and <code>reject!</code> Check it out:</p>

<p><img src="http://kaylee42.github.io/images/pry/find-method.png" alt="using find-method with pry" /></p>

<p>find-method will ALSO search methods that you have written if you are in a session initiated through a breakpoint.</p>

<p>You can also pull up examples of the source code for any method using <code>show-source Class#method</code> (aliased as <code>$</code>). However, for a baby developer such as myself, this has not proved particularly for Ruby methods as I can’t understand anything written in C, and honestly at this point I just need to know how a thing works.</p>

<p><em>Flatiron-specific note on using pry-doc: For some reason, pry-doc does NOT play well with learn. If you drop into pry from a directory containing a lab, or your binding.pry was in a lab, you will NOT be able to access the pry-doc. I’m honestly at a loss as to why this happens.</em></p>

<h2>BUT WAIT… WHAT ABOUT METHODS I WROTE?</h2>

<p>Glad you asked… because pry can tell you about those too!!!</p>

<p>It’s a basic functionality of pry that using the command <code>ls</code> will allow you to see the methods that can be called on a given object. Below are three examples of how this can be implemented:
<code>ls</code> will default to the methods belonging to self (whatever self is at the time)
<code>ls Class/Module</code> will show all methods available to that class and instances of the class
<code>ls variable</code> will show all methods available to that particular object</p>

<p><img src="http://kaylee42.github.io/images/pry/ls-general.png" alt="using ls with pry" /></p>

<p>This seems like it would be pretty helpful in and of itself. BUT! Let’s check out what happens when we call in on classes and instances that we’ve written, rather than those that come with Ruby.</p>

<p>So we’re inside our binding.pry, bopping around and trying to remember what methods a given instance has access to. Let’s see what happens when we call ls on our class Artist, as well as an instance of that class called artist:</p>

<p><img src="http://kaylee42.github.io/images/pry/ls-artist.png" alt="using ls with pry 2" /></p>

<p>Woah! That’s all the methods we wrote. And not only that, but they’re separated out based on inheritance. We can see that under the list for our Artist class, we first get the methods extended from the module Concerns::Findable, then the class methods from the parent class Genre, then the class methods from Artist itself, then the instance methods available to instance of the Artist class, and finally a list of class variables.</p>

<p>In the list for instance artist, we see first the instance methods from the parent class, then the instance methods from Artist, and finally both the instance and class variables. Note that though both the Genre and Artist classes contain #name methods, only the one contained in the Artist class is listed, as it is the one that our artist instance would use based on the rules of inheritance.</p>

<p>You may have noticed that we only see public methods in this list. If you’d like to see private methods as well, you can add a -p flag: <code>ls artist -p</code>, and it will give a list with private methods highlighted. There are many other options as well; calling <code>ls -h</code> provides a full list.</p>

<p><img src="http://kaylee42.github.io/images/pry/private-methods.png" alt="ls private methods with pry" /></p>

<p>But wait, there’s more!. This app is pretty small, and the methods are pretty simple. But what if I’m debugging a much larger app, one with many more methods and more complex inheritance relationships. What if during the debugging process I can’t figure out why a particular method isn’t behaving as expected? Wouldn’t it be nice if I could see the source code for that method?</p>

<p><img src="http://kaylee42.github.io/images/pry/show-source.png" alt="using show-source with pry" /></p>

<p>By entering <code>show-source Class/instance.method</code>, pry pulls up the source of that method. It gives us the file and line location of the code, the owner (class or module) of the method, and then shows us the code itself so we can understand exactly how it’s operating.</p>

<p>Note that this show-source syntax is slightly different than the one utilized in the pry-doc calls - you put Class.method as opposed to Class#method.</p>

<h2>MOVING IN AND OUT OF OBJECTS</h2>

<p>Pry includes a &lsquo;cd&rsquo; command that works almost identically to what we&rsquo;re used to in terminal, except that it allows us to move in and out of objects. Once you &lsquo;cd&rsquo; into an object, that object becomes self until you &lsquo;cd&rsquo; again, allowing you to directly call commands like &lsquo;ls&rsquo; or any methods available to that object. Let&rsquo;s take a look:</p>

<p><img src="http://kaylee42.github.io/images/pry/cd.png" alt="using cd in pry" /></p>

<p>Here we can see that we <code>cd</code> directly into an an instance of the dog class, and that from there <code>ls</code> gives us a list of variable and methods for that object as it is not self. Pry then allows us to <code>cd</code> directly into the instance variable <code>@id</code>, and we can receive a list of methods available for it. Just as in terminal, using <code>cd ..</code> will move us back up a single level, and we can now call the name method directly on our instance of the Dog class.</p>

<p>Pry also helps you keep track of where you are and how many levels you have moved in the cursor the far left where it says: <code>pry(location):level&gt;</code></p>

<h2>QUICK TIPS</h2>

<ul>
<li>Accessing the terminal: Do you need to quickly do something in the terminal but don’t want to exit your pry session? Append a period to any command and it will get passed to the shell:</li>
</ul>


<p><img src="http://kaylee42.github.io/images/pry/terminal.png" alt="using terminal from within pry" /></p>

<p>The list given is for the current directory, not for an item in the code we are prying into.</p>

<ul>
<li>Have you been prying for too long and lost yourself? <code>whereami</code> will remind you where in the code you currently are. This is automatically executed when you open pry, but <code>whereami</code> follows any line plays you may have made, and also takes an optional parameter of the number of lines to show before or after your location, as well as reminding you where in your file this code originates from.</li>
</ul>


<p><img src="http://kaylee42.github.io/images/pry/whereami.png" alt="using whereami in pry" /></p>

<ul>
<li>Use <a href="https://github.com/danvisintainer/prybaby">prybaby</a> to automatically comment out all of the pry breakpoints in the directory you are working in. Simply run <code>gem install prybaby</code> to get started. Once it&rsquo;s installed, run <code>prybaby</code> in terminal to comment out your breakpoints. Use <code>prybaby -u</code> to uncomment all the breakpoints, and <code>prybaby -r</code> to delete them. (Beware though - it deletes the entire line containing the <code>binding.pry</code>.) Thanks Sophie for this recommendation!</li>
</ul>


<h2>RESOURCES &amp; FURTHER READING</h2>

<ul>
<li><a href="https://github.com/pry/pry/wiki">Pry Wiki</a></li>
<li><a href="http://www.sitepoint.com/rubyists-time-pry-irb/">Rubyists, It’s Time to PRY Yourself Off IRB!</a></li>
<li><a href="https://www.bignerdranch.com/blog/my-top-5-pry-features/">My Top 5 Pry Features</a></li>
</ul>

]]></content>
  </entry>
  
</feed>
